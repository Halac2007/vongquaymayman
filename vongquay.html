<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>V√≤ng Quay May M·∫Øn</title>
    <style>
      body {
        font-family: "Segoe UI", sans-serif;
        background: radial-gradient(circle at center, #ffeaa7, #fab1a0);
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        margin: 0;
        overflow: hidden;
      }

      .container {
        display: flex;
        align-items: center;
        gap: 60px;
      }

      .left-panel {
        text-align: center;
      }

      .right-panel {
        text-align: center;
      }

      h1 {
        color: #2d3436;
        margin-bottom: 30px;
        font-size: 50px;
        text-shadow: 1px 1px 2px #fff;
      }

      .wheel-wrapper {
        position: relative;
        width: 580px;
        height: 580px;
        margin: 0 auto;
      }

      .wheel {
        width: 100%;
        height: 100%;
        border-radius: 50%;
        border: 12px solid #fff;
        background: conic-gradient(
          #e79600 0deg 45deg,
          #0080ff 45deg 90deg,
          #00ffb7 90deg 135deg,
          #ff2f00 135deg 180deg,
          #ffc400 180deg 225deg,
          #1100ff 225deg 270deg,
          #ff0059 270deg 315deg,
          #00ffff 315deg 360deg
        );
        box-shadow: 0 0 30px rgba(0, 0, 0, 0.2);
        transition: transform 4s ease-in-out;
      }

      .pointer {
        position: absolute;
        top: -40px;
        left: 50%;
        transform: translateX(-50%);
        font-size: 40px;
        color: #d63031;
        text-shadow: 1px 1px 2px #fff;
      }

      button {
        margin-top: 40px;
        padding: 14px 35px;
        font-size: 20px;
        font-weight: bold;
        border: none;
        border-radius: 12px;
        background: linear-gradient(to right, #0984e3, #74b9ff);
        color: white;
        cursor: pointer;
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2);
        transition: transform 0.2s ease, background-color 0.3s ease;
      }

      button:hover {
        transform: scale(1.05);
        background: linear-gradient(to right, #74b9ff, #0984e3);
      }

      .result {
        margin-top: 30px;
        font-size: 240px;
        color: #fd3434;
        font-weight: 900;
        text-shadow: 2px 2px 5px rgba(0, 0, 0, 0.2);
        animation: popIn 0.3s ease-out;
      }

      @keyframes popIn {
        0% {
          transform: scale(0.6);
          opacity: 0;
        }
        100% {
          transform: scale(1);
          opacity: 1;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="left-panel">
        <img src="https://static.plo.vn/v4/web/styles/img/plo-logo.svg" alt="Logo Ch∆∞∆°ng Tr√¨nh" style="max-width: 200px; height: auto; margin-bottom: 20px" />

        <h1>üéâ V√íNG QUAY MAY M·∫ÆN üéâ</h1>
        <button id="spinBtn">QUAY</button>
        <div id="result" class="result">--</div>
      </div>

      <div class="right-panel">
        <div class="wheel-wrapper">
          <div class="pointer">‚ñ≤</div>
          <div id="wheel" class="wheel"></div>
        </div>
      </div>
    </div>

    <audio id="backgroundMusic" loop>
      <source src="NhacXoSo.mp3" type="audio/mpeg" />
    </audio>

    <audio id="spinSound">
      <source src="quayso.mp3" type="audio/mpeg" />
    </audio>

    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <script>
      const wheel = document.getElementById("wheel");
      const spinBtn = document.getElementById("spinBtn");
      const result = document.getElementById("result");
      const backgroundMusic = document.getElementById("backgroundMusic");
      const spinSound = document.getElementById("spinSound");

      let isSpinning = false;
      let currentRotation = 0;

      // T·ª± ƒë·ªông ph√°t nh·∫°c n·ªÅn khi t·∫£i trang
      window.addEventListener("load", () => {
        backgroundMusic.volume = 0.5;
        backgroundMusic.play().catch((e) => {
          console.log("T·ª± ƒë·ªông ph√°t nh·∫°c n·ªÅn b·ªã ch·∫∑n:", e);
        });
      });

      spinBtn.addEventListener("click", () => {
        if (isSpinning) return;

        isSpinning = true;
        result.textContent = "--";
        result.style.animation = "none";

        // D·ª´ng nh·∫°c n·ªÅn n·∫øu ƒëang ph√°t
        if (!backgroundMusic.paused) {
          backgroundMusic.pause();
          backgroundMusic.currentTime = 0;
        }

        // ƒê·∫∑t l·∫°i v√† ph√°t √¢m thanh quay
        if (!spinSound.paused) {
          spinSound.pause();
          spinSound.currentTime = 0;
        }
        spinSound.play();

        const luckyNumber = Math.floor(Math.random() * 300) + 1;
        const rounds = 4 + Math.floor(Math.random() * 4);
        const degreeOffset = Math.floor(Math.random() * 360);
        const spinDeg = rounds * 360 + degreeOffset;
        currentRotation += spinDeg;

        wheel.style.transition = "transform 4s ease-in-out";
        wheel.style.transform = `rotate(${currentRotation}deg)`;

        setTimeout(() => {
          result.textContent = luckyNumber.toString().padStart(2, "0");
          result.style.animation = "none";
          void result.offsetWidth;
          result.style.animation = "popIn 0.3s ease-out";

          // D·ª´ng √¢m thanh quay v√† ph√°t l·∫°i nh·∫°c n·ªÅn
          spinSound.pause();
          spinSound.currentTime = 0;

          backgroundMusic.play().catch((e) => {
            console.log("Kh√¥ng th·ªÉ ph√°t l·∫°i nh·∫°c n·ªÅn:", e);
          });

          // B·∫Øn ph√°o hoa kh·∫Øp m√†n h√¨nh
          for (let i = 0; i < 6; i++) {
            setTimeout(() => {
              confetti({
                particleCount: 100,
                spread: 160,
                startVelocity: 40,
                origin: {
                  x: Math.random(),
                  y: Math.random() * 0.5,
                },
              });
            }, i * 300);
          }

          isSpinning = false;
        }, 4100);
      });
    </script>
  </body>
</html>
